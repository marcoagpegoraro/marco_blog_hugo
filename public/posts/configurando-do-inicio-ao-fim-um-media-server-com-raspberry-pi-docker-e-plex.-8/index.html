<!DOCTYPE html>
<html lang="en">

    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><title>Configurando do inicio ao fim um media server com Raspberry PI, Docker e Plex. &ndash; Blog do Marco(Marco&#39;s Blog)</title>


<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="UTF-8"/>



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<link rel="stylesheet" href="http://localhost:1313/css/palettes/base16-dark.css">
<link rel="stylesheet" href="http://localhost:1313/css/risotto.css">
<link rel="stylesheet" href="http://localhost:1313/css/custom.css">







</head>

    <body>
        <div class="page">

            <header class="page__header"><nav class="page__nav main-nav">
    <ul>
      <li class="nomarker"><h1 class="page__logo"><a href="http://localhost:1313/" class="page__logo-inner">Blog do Marco(Marco&#39;s Blog)</a></h1></li>
    
    
    </ul>
</nav>

</header>

            <section class="page__body">
    <header class="content__header">
        <h1>Configurando do inicio ao fim um media server com Raspberry PI, Docker e Plex.</h1>
    </header>
    <div class="content__body">
        <h1 id="httpsmiromediumcomv2resizefit14001gsqi4vm5akhcvlgsq_8fywjpegintrodução"><img src="https://miro.medium.com/v2/resize:fit:1400/1*GsqI4vM5akhcVLgsq_8Fyw.jpeg" alt="">Introdução</h1>
<p>Há tempos que tinha um Raspberry PI 3 aqui comigo porém nunca cheguei a utilizar ele para nada além de alguns testes para ver o funcionamento, pois bem, recentemente comprei uma smart TV, e nela, eu conseguia assistir meus filmes, series e animes pelo meu HD externo, foi ai que pensei na ideia, e se fosse possível utilizar meu Raspberry como um <em>media server</em> e acessar meus vídeos diretamente pela TV utilizando minha rede local?</p>
<h1 id="começo-do-projeto">Começo do projeto</h1>
<p>Foi ai que comecei meu projeto para fazer meu pequeno servidor de media, o Raspberry eu já tinha, só faltava comprar o armazenamento dele e a fonte, optei por um cartão micro SDHC 1 de 32GB que já é mais do que suficiente para instalar o que eu preciso e uma fonte básica micro USB, lembrando que a fonte para o Raspberry deve ser de 5 Volts (V) e 3 Amperes (A). Feito isso, baixei o programa <a href="https://www.raspberrypi.com/software/">Raspberry PI Imager</a> para gravar a imagem Linux no meu cartão SD, optei por instalar o Ubuntu Server na versão 20.04 LTS mas você poderia instalar a distro de sua preferência para esse projeto.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1380/1*B5bpnaQIwewf35hu6vu2UQ.png" alt=""></p>
<p>O Raspberry Pi Imager é um programa que facilita muito instalar um sistema operacional em um cartão de memória</p>
<blockquote>
<p>Eu já tinha um Raspberry PI 3, mas se você for começar este projeto do zero, recomendo fortemente e investir mais um pouco em um Raspberry PI 4, além do ganho de performance, a versão 4 possui a entrada USB 3.0, o que faz o servidor de arquivos ter um ganho de velocidade muito maior que a do USB 2.0 que meu Raspberry PI 3 possui.</p>
</blockquote>
<h1 id="configuração-do-sistema-operacional">Configuração do sistema operacional</h1>
<p>Depois da distro instalada, o próximo passo foi colocar o cartão no slot do PI e conectar a fonte, ao ligar, ele vai pedir para realizar o login, no caso do Ubuntu, é &ldquo;ubuntu&rdquo; e senha &ldquo;ubuntu&rdquo;, depois será necessário definir uma nova senha. A primeira coisa que eu gosto de fazer é deixar um IP fixo para meu Raspberry, para ser mais fácil acessar ele remotamente no futuro. Para isso, vou linkar as fontes dos materiais que achei na internet.</p>
<p>Como configurar um endereço de IP fixo no Ubuntu:</p>
<p><a href="https://linuxize.com/post/how-to-configure-static-ip-address-on-ubuntu-18-04/">https://linuxize.com/post/how-to-configure-static-ip-address-on-ubuntu-18-04</a>/</p>
<blockquote>
<p>Opcional (porem essencial): <strong>SSH</strong></p>
</blockquote>
<blockquote>
<p>Depois de configurar um IP estático para a maquina, o ideal é que você comece a acessar via SSH da sua maquina de uso normal, a praticidade é ordens de grandeza maior do que ficar com o Raspberry plugado a um monitor, teclado e mouse. Para utilizar o SSH, não tive que fazer nada pois já veio habilitado o SSH no meu Ubuntu, mas você pode seguir este tutorial para verificar se o seu está funcionando também:</p>
</blockquote>
<blockquote>
<p><a href="https://linuxize.com/post/how-to-enable-ssh-on-ubuntu-20-04/">https://linuxize.com/post/how-to-enable-ssh-on-ubuntu-20-04/</a></p>
</blockquote>
<p>Em seguida, como estou utilizando WIFI, eu precisei configurar mais uma parte para o Raspberry conseguir acessar a internet, mas eu recomendo fortemente que você utilize conexão via cabo, tanto pela performance quanto pela facilidade, eu só não utilizei pois não tenho um cabo Ethernet aqui comigo no momento (acontece):</p>
<p><a href="https://linuxconfig.org/ubuntu-20-04-connect-to-wifi-from-command-line">https://linuxconfig.org/ubuntu-20-04-connect-to-wifi-from-command-line</a></p>
<p>Com a minha internet funcionando e com o IP fixo já configurado, o ultimo passo do setup do sistema operacional vai ser montar o drive toda vez que o PI ligar, para isso, precisei baixar alguns pacotes para ler o <em>filesystem</em> exFAT do meu HD externo (se possível, utilize outro sistema de arquivos mais confiável, para mais detalhes <a href="https://askubuntu.com/questions/319512/mount-exfat-drive-on-ubuntu-not-as-root">clique aqui</a>):</p>
<p>sudo apt-get install exfat-utils exfat-fuse
2023/10/20 23:02:51 stdout:
Depois disso, editei meu arquivo /etc/fstab e coloquei a seguinte linha nele para montar meu HD toda vez que acontecer o boot do sistema:</p>
<p>/dev/sda1       /media/hd2tb    exfat   rw,async,umask=0 0 0
2023/10/20 23:02:51 stdout:</p>
<h1 id="instalação-dos-softwares">Instalação dos softwares</h1>
<p>O próximo passo foi instalar o Docker para que possamos configurar o container do Plex Media Server, que no caso, será o programa responsável por fazer o streaming para a televisão:</p>
<h2 id="how-to-install-docker-on-ubuntu-1804-2021-tutorialhttpsphoenixnapcomkbhow-to-install-docker-on-ubuntu-18-04sourcepost5fpage-----3c9b84a9dda5--------------------------------"><a href="https://phoenixnap.com/kb/how-to-install-docker-on-ubuntu-18-04?source=post%5Fpage-----3c9b84a9dda5--------------------------------">How to Install Docker On Ubuntu 18.04 {2021 Tutorial}</a></h2>
<h3 id="docker-is-an-increasingly-popular-software-package-that-creates-a-container-for-application-development-developing-inhttpsphoenixnapcomkbhow-to-install-docker-on-ubuntu-18-04sourcepost5fpage-----3c9b84a9dda5--------------------------------"><a href="https://phoenixnap.com/kb/how-to-install-docker-on-ubuntu-18-04?source=post%5Fpage-----3c9b84a9dda5--------------------------------">Docker is an increasingly popular software package that creates a container for application development. Developing in…</a></h3>
<p><a href="https://phoenixnap.com/kb/how-to-install-docker-on-ubuntu-18-04?source=post%5Fpage-----3c9b84a9dda5--------------------------------">phoenixnap.com</a></p>
<p>Com o docker instalado na maquina, será necessário criar o container do Plex, pra isso, existe uma imagem já pronta feita pelo <a href="https://www.linuxserver.io/">LinuxServer</a>:</p>
<p><a href="https://hub.docker.com/r/linuxserver/plex">https://hub.docker.com/r/linuxserver/plex</a></p>
<p>Eu criei o container utilizando o comando &ldquo;docker run&rdquo;, porém você também pode optar por utilizar o Dockerfile, fica ao seu critério, os únicos valores que eu alterei foram estes:</p>
<p>-v /path/to/library:/config -v /path/to/tvseries:/tv -v /path/to/movies:/movies
2023/10/20 23:02:51 stdout:
Coloquei o caminho no qual está meus vídeos. No caso &ldquo;/media/hd2tb/Videos&rdquo;.</p>
<p>Com o container do Plex funcionando, você já poderá acessar o servidor do Plex via navegador, é só digitar o endereço IP do seu Raspberry PI, na porta 32400, no meu caso, ficou &ldquo;<a href="http://192.168.0.100:32400/web/index.html#!/">http://192.168.0.100:32400/web/index.html#!/</a>&rdquo;</p>
<p>Depois disso, você só precisará fazer as configurações que o Plex necessita, apontar onde está sua pasta de vídeos e seus vídeos já estarão disponíveis para seus clientes Plex.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/1*t9h0CGyK6XrUckan6VjsMg.jpeg" alt=""></p>
<p>Assistindo Akira diretamente da minha televisão utilizando o Plex.</p>
<h1 id="extra---configurando-um-servidor-samba-para-gerenciamento-dos-arquivos">Extra - configurando um servidor Samba para gerenciamento dos arquivos:</h1>
<p>Agora com seus vídeos conectados no Raspberry, o ideal seria que nós conseguíssemos editar os arquivos a vontade, certo? para isso, existem diversas maneiras, mas a minha favorita é compartilhar o HD externo na rede local para qualquer computador com acesso consiga acessar e fazer modificações diretamente no drive, para isso, vamos utilizar o Samba para compartilhar nosso drive na rede.</p>
<p>Existe um tutorial bem fácil para instalar e configurar o Samba na própria documentação do Ubuntu:</p>
<p><a href="https://ubuntu.com/tutorials/install-and-configure-samba">https://ubuntu.com/tutorials/install-and-configure-samba</a></p>
<p>Só que ao invés de criar uma pasta nova, você irá compartilhar seu drive, no meu caso, compartilhei o caminho &ldquo;/media/hd2tb&rdquo;, depois de configurar o caminho e os usuários samba, só nos resta testar utilizando outro computador na rede, utilizei um computador macOS, mas poderia ser qualquer sistema operacional</p>
<p><img src="https://miro.medium.com/v2/resize:fit:1400/1*iNDbly8zpgjdfEluPrvM_w.png" alt=""></p>
<p>Podemos ver que agora nós conseguimos acessar e editar ao nosso gosto nossa pasta de vídeos do Plex de uma maneira fácil e intuitiva.</p>
<p>E com isso, termino meu tutorial, uma das vantagens de usar o Docker é a facilidade de subir containers sem atrapalhar os demais containers que já estão em funcionamento, no futuro planejo subir um container com o <a href="https://pi-hole.net/">Pi-hole</a> para bloquear os anúncios na minha rede interna, e quem sabe até um <a href="https://rancher.com/">Rancher</a> para monitorar meus containers, mas isso fica para outro tutorial, se gostaram, não deixem de bater palmas para o artigo e compartilhem com quem você acha que esse artigo seria útil, fico por aqui, até mais!</p>
<h2 id="miscellaneous">Miscellaneous:</h2>
<p>Na primeira tentativa ao realizar este projeto, eu fiz não utilizando o Docker nem o Plex, para configurar o servidor de media, eu utilizei um programa chamado MiniDLNA, no qual tem um funcionamento bem semelhante porem muito mais simples e direto, fica ai esta alternativa para quem quiser instalar também, o protocolo DLNA é reconhecido pela maioria das TVs atuais, tanto que a minha reconheceu na primeira tentativa, vou estar deixando um tutorial muito interessante que encontrei no Youtube sobre como instalar o programa:</p>
<p>Referencias:</p>
<p><a href="https://askubuntu.com/questions/319512/mount-exfat-drive-on-ubuntu-not-as-root">https://askubuntu.com/questions/319512/mount-exfat-drive-on-ubuntu-not-as-root</a></p>

    </div>
    <footer class="content__footer"></footer>

            </section>

            <section class="page__aside">
                <div class="aside__about">

<ul class="aside__social-links">
    
</ul>
</div>
                <hr>
                <div class="aside__content">
    
    
        <p>
            By Marco Pegoraro, 
            2022-01-04
        </p>
    

    

                </div>
            </section>

            <footer class="page__footer"><p>
    
    
    
    
    
    
    
    
      
      
          
            
            
                <br/><span class="active">$ echo $LANG<br/><b></b></span><br/>

            
          
      
    
</p>
<br /><br />
<p class="copyright"></p>
<p class="advertisement">Powered by <a href="https://gohugo.io/">hugo</a> and <a href="https://github.com/joeroe/risotto">risotto</a>.</p>
</footer>

        </div>
    </body>

</html>
